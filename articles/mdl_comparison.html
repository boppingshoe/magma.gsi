<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparing MAGMA model algorithms • magma.gsi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparing MAGMA model algorithms">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">magma.gsi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/age_prior_comparison.html">Age priors configurations comparison</a></li>
    <li><a class="dropdown-item" href="../articles/magma-vignette.html">How not to be engulfed by MAGMA: instructions and model descriptions</a></li>
    <li><a class="dropdown-item" href="../articles/mdl_comparison.html">Comparing MAGMA model algorithms</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/boppingshoe/magma.gsi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="mdl_comparison_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="mdl_comparison_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="mdl_comparison_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="mdl_comparison_files/datatables-binding-0.34.0/datatables.js"></script><link href="mdl_comparison_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="mdl_comparison_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="mdl_comparison_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="mdl_comparison_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="mdl_comparison_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="mdl_comparison_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="mdl_comparison_files/selectize-0.12.0/selectize.min.js"></script><link href="mdl_comparison_files/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="mdl_comparison_files/crosstalk-1.2.2/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Comparing MAGMA model algorithms</h1>
            <h3 data-toc-skip class="subtitle">Conditional GSI Vs. Fully
Bayesian</h3>
                        <h4 data-toc-skip class="author">Bobby Hsu</h4>
            
            <h4 data-toc-skip class="date">December 17, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/boppingshoe/magma.gsi/blob/master/vignettes/articles/mdl_comparison.Rmd" class="external-link"><code>vignettes/articles/mdl_comparison.Rmd</code></a></small>
      <div class="d-none name"><code>mdl_comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<ul>
<li>Compare model algorithms of “fully Bayesian” and “conditional GSI”
of MAGMA by assessing error, deviation, bias and MCMC convergence of the
estimates.</li>
</ul>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>MAGMA is a Bayesian mixture model used for GSI applications. When we
“run” the MAGMA model, we employ a MCMC algorithm to estimate stock
proportions, age-by-stock composition, and individual group membership
assignments. MAGMA algorithm is modified from a mixture model first
developed by Pella and Masuda (2001; i.e., Pella-Masuda model or “fully
Bayesian” model). The underlying principles of MAGMA and Pella-Masuda
models are the same, except that MAGMA incorporates age and marking
information in addition to the genetics. Also, MAGMA is designed for
analyses containing multiple strata, which makes running MAGMA model
more computationally intensive than the Pella-Masuda model.</p>
<p>That is not to say that the Pella-Masuda model is simple; it has an
intricate algorithm and running the program BAYES can be a
time-consuming process. To decrease time spent on running the model (and
improve convergence of the MCMC sampler), Moran and Anderson (2018)
developed a conditional mixture model by modifying the Pella-Masuda
model. The conditional model (i.e., “conditional GSI”) streamlines the
fully Bayesian algorithm by eliminating a step to recalculate allele
frequencies of the baseline populations. This step is often referred to
as “baseline re-sampling,” where, at each iteration of MCMC sampling,
mixture individuals are assigned a new population membership, and the
allele frequencies of each population can shift due to changes in its
membership. Therefore, in the fully Bayesian algorithm, allele
frequencies are re-calculated at each iteration. This step can be
computational intensive with a large mixture sample and/or a big genetic
marker set.</p>
<p>Moran and Anderson (2018) found that the baseline re-sampling step
can be mathematically integrated out of the model algorithm, and the
resulting conditional model would yield the same results as the fully
Bayesian model without the computationally intensive calculations. We
incorporate the conditional model in the sampling algorithm for MAGMA,
but with some modifications to incorporate age and marking information.
Basically, our modifications to MAGMA algorithm are a hybrid of the
fully Bayesian and the conditional models.</p>
<p>However, we have not assessed the effects of the hybrid model on the
estimation in a MAGMA setting. In this document, I use a
cross-validation analysis to assess the possible effects of the hybrid
conditional GSI on the accuracy and precision of the MAGMA model.</p>
<div class="section level3">
<h3 id="update-for-october-2024-lynn-canal">Update for October 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-october-2024-lynn-canal"></a>
</h3>
<p>I updated the analysis with Lynn Canal sockeye baseline and a
multi-stratum set up. Lynn Canal post-season reporting has 251
collections divided into seven groups. Majority of collections are
included in the “Other” reporting group. For age, there are 15 classes
total. Five of them are major age classes (03, 12, 13, 22, 23), and the
rest are included in “other.”</p>
</div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="yukon-chinook">Yukon Chinook<a class="anchor" aria-label="anchor" href="#yukon-chinook"></a>
</h3>
<p>I used a Yukon Chinook baseline for the simulation. The Chinook
baseline was modified in a previous analysis and contained only a
portion of the original collections. This modified baseline had a
marker-set of 380 loci that could differentiate Chinook salmon among
four reporting groups from the middle/upper Yukon River (Koyukuk,
Tanana, Upper U.S., and Canada; Lee et al. 2021). I used the modified
baseline to generate 100 sets of MAGMA mixtures (one district, one
subdistrict, and one week) with randomly set age-by-stock compositions,
and ran the mixtures using hybrid conditional GSI and fully Bayesian
algorithms. Finally, I calculated and compared root mean-square-errors
(RMSE), deviations, and mean bias for the 100 simulations.</p>
<p>Procedures for generating one set of MAGMA data are as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Randomly set proportions for the four reporting groups. Based on
the set proportions, randomly allocate 190 individuals to populations
within each reporting group.</p></li>
<li><p>Simulate genotypes of mixture individuals based on the baseline
allele frequencies corresponding to their assigned population
memberships. The simulated values are drawn from multinomial
distributions.</p></li>
<li><p>randomly set proportions for the age-by-stock compositions. The
age-by-stock composition is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">4 \times 9</annotation></semantics></math>
matrix with rows represent reporting groups and columns represent age
classes. There are nine age classes and they are ages 1.1, 1.2, 1.3,
2.1, 2.2, 2.3, 3.1, 3.2, and 3.3. The proportions for ages 1.1, 1.2, and
3.3 are always 0’s in this analysis, and the rest are randomly set. The
age proportions within each reporting group add up to 1.</p></li>
<li><p>Assign an age for each mixture individual based on its assigned
reporting group membership. Randomly withheld the age identities for 15%
of the mixture individuals.</p></li>
<li><p>Format the data set for MAGMA model (using
<code>magmatize data()</code> function). There is only one district, one
subdistrict, and one week in the mixture data set.</p></li>
</ol>
<p>I ran each of the 100 MAGMA data sets with two model algorithms: 1)
“conditional GSI”: a hybrid algorithms that re-sample baseline allele
frequencies every 10th iteration and 2) “fully Bayesian”: re-sample
baseline allele frequencies every iteration. I ran each model with 1,000
iterations, 500 burn-ins, no thinning, and four chains with “zero out”
age priors.</p>
<p>I compared the posterior means and the true proportions of the nine
age classes and calculated RMSE and bias/deviation. RMSE is calculated
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>−</mo><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt><annotation encoding="application/x-tex">\sqrt{\frac{1}{n} \sum_{i=1}^{n} (Y_i - \hat Y_i)^2}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
was the number of cross-validation analyses,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
was the true proportion of age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math><sup>th</sup>
analysis, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><annotation encoding="application/x-tex">\hat Y_i</annotation></semantics></math>
was the posterior mean proportion of age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math><sup>th</sup>
analysis. Mean bias was the mean of the differences between the
posterior mean and the true proportion of each age class for each
cross-validation analysis. “Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
0.1” quantified the portion of the cross-validation analyses with
absolute biases greater or equal to 0.1.</p>
</div>
<div class="section level3">
<h3 id="update-for-october-2024-lynn-canal-1">Update for October 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-october-2024-lynn-canal-1"></a>
</h3>
<p>Simulations for Lynn Canal followed the same procedures as before,
with addition of multiple strata. There were one district and two
subdistricts with two weeks each. Age-by-stock composition was a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn><mo>×</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">7 \times 15</annotation></semantics></math>
matrix for the whole district. I ran two sets of simulations. The first
set had 0 portion for all minor age classes. The second set had a small
portion (randomly set) for some of the minor age classes.</p>
<p>Harvest were randomly selected from the 2023 harvest record to
represent a simulated harvest for the four strata in each iteration of
the analysis. Sample size for each stratum was randomly drawn from a
negative binomial distribution with a mean of 190 fish and a dispersion
parameter of 8
(Neg-bin(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
= 190, size = 8)).</p>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="yukon-chinook-1">Yukon Chinook<a class="anchor" aria-label="anchor" href="#yukon-chinook-1"></a>
</h3>
<div class="section level4">
<h4 id="precision">Precision<a class="anchor" aria-label="anchor" href="#precision"></a>
</h4>
<p>I plotted the comparisons between the posterior means and the true
values and the performances were similar between the two algorithms for
the four reporting groups (Figure 1).</p>
<p><img src="mdl_comparison_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="Figure 1 precision yukon chinook" width="960">
Figure 1: Comparison between the posterior means and the true values of
the 100 cross-validation analyses for the two model algorithms: ‘Cond.
GSI’ and ‘Fully Bayes.’ Diagonal line represents 1:1 relationship
between the true proportions and the posterior means. Dashed lines mark
the ± 0.1 deviation from the 1:1 line.</p>
</div>
<div class="section level4">
<h4 id="rmse">RMSE<a class="anchor" aria-label="anchor" href="#rmse"></a>
</h4>
<p>The performances of the two algorithms were similar. If you squint
really hard, you might find that conditional GSI had slightly lower
RMSE’s for Koyukuk and Tanana (Table 1; Figure 2).</p>
<p>Table 1: Comparison of root mean-square-errors for each age class
among the two model algorithms.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.113\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.128\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],["Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS"],["Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33","Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33","Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33","Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33"],[0,0,0.025,0.032,0.025,0.026,0.027,0.027,0,0,0,0.059,0.043,0.049,0.07000000000000001,0.051,0.043,0,0,0,0.07000000000000001,0.113,0.076,0.073,0.09,0.063,0,0,0,0.041,0.045,0.045,0.047,0.039,0.048,0],[0,0,0.026,0.031,0.029,0.027,0.028,0.026,0,0,0,0.076,0.055,0.066,0.078,0.066,0.066,0,0,0,0.082,0.128,0.08599999999999999,0.075,0.099,0.074,0,0,0,0.049,0.055,0.049,0.056,0.051,0.052,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>age<\/th>\n      <th>Cond. GSI<\/th>\n      <th>Fully Bayes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"group","targets":1},{"name":"age","targets":2},{"name":"Cond. GSI","targets":3},{"name":"Fully Bayes","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="mdl_comparison_files/figure-html/mse-1.png" class="r-plt" alt="Figure 2 Root mean-square-errors yukon chinook" width="864">
Figure 2: Root mean-square-errors of each age class for the two model
algorithms.</p>
</div>
<div class="section level4">
<h4 id="bias">Bias<a class="anchor" aria-label="anchor" href="#bias"></a>
</h4>
<p>The two algorithms of MAGMA exhibited similar amount of biases (or
lack thereof) for the four reporting groups (Figure 3).</p>
<p><img src="mdl_comparison_files/figure-html/bias-1.png" class="r-plt" alt="Figure 3 Bias yukon chinook" width="864">
Figure 3: Bias of each age class for the two model algorithms.</p>
</div>
<div class="section level4">
<h4 id="deviation-geq-0-1">Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
0.1<a class="anchor" aria-label="anchor" href="#deviation-geq-0-1"></a>
</h4>
<p>Hybrid conditional GSI seemed to perform slightly better than fully
Bayesian algorithm overall (Table 2; Figure 4).</p>
<p>Table 2: Comparison of deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
for each age class among the two model algorithms.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.15\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.2\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],["Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Koyukuk","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","Tanana","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS","UpperUS"],["Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33","Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33","Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33","Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33"],[0,0,0,0.01,0.01,0,0,0.01,0,0,0,0.09,0.04,0.06,0.05,0.07000000000000001,0.04,0,0,0,0.09,0.15,0.13,0.09,0.14,0.11,0,0,0,0.03,0.04,0.04,0.05,0.01,0.05,0],[0,0,0,0.01,0.01,0,0,0.01,0,0,0,0.16,0.07000000000000001,0.12,0.06,0.13,0.1,0,0,0,0.11,0.2,0.2,0.12,0.2,0.15,0,0,0,0.07000000000000001,0.1,0.07000000000000001,0.08,0.09,0.07000000000000001,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>age<\/th>\n      <th>Cond. GSI<\/th>\n      <th>Fully Bayes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"group","targets":1},{"name":"age","targets":2},{"name":"Cond. GSI","targets":3},{"name":"Fully Bayes","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="mdl_comparison_files/figure-html/deviations-1.png" class="r-plt" alt="Figure 4 deviation yukon chinook" width="864">
Figure 4: Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
0.1 of each age class for the two model algorithms.</p>
</div>
<div class="section level4">
<h4 id="gelman-rubin-diagnostic-gr">Gelman-Rubin diagnostic (GR)<a class="anchor" aria-label="anchor" href="#gelman-rubin-diagnostic-gr"></a>
</h4>
<p>I also compared the convergence of the posterior samples between the
two algorithms by plotting the Gelman-Rubin shrink factor (GR) of 100
simulations in overlapping histograms (Figure 5). The convergence seemed
to be similar between the two algorithms.</p>
<p><img src="mdl_comparison_files/figure-html/gr-1.png" class="r-plt" alt="Figure 5 gr yukon chinook" width="864">
Figure 5: Gelman-Rubin diagnostic (GR) of each reporting group for the
two model algorithms.</p>
</div>
</div>
<div class="section level3">
<h3 id="update-for-october-2024-lynn-canal-2">Update for October 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-october-2024-lynn-canal-2"></a>
</h3>
<div class="section level4">
<h4 id="precision-1">Precision<a class="anchor" aria-label="anchor" href="#precision-1"></a>
</h4>
<p>Comparisons between the posterior means and the true values showed
that the performances were similar between the two algorithms for the
seven reporting groups of the Lynn Canal sockeye baseline (Figure
6).</p>
<p><img src="mdl_comparison_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="Figure 6 precision lynn" width="768"></p>
<p>Figure 6: Comparison between the posterior means and the true values
of the 100 cross-validation analyses for the two model algorithms,
‘Cond. GSI’ and ‘Fully Bayes,’ using the Lynn Canal sockeye baseline.
Diagonal line represents 1:1 relationship between the true proportions
and the posterior means. Dashed lines mark the ± 0.1 deviation from the
1:1 line.</p>
</div>
<div class="section level4">
<h4 id="rmse-1">RMSE<a class="anchor" aria-label="anchor" href="#rmse-1"></a>
</h4>
<p>Errors of the two algorithms were similar for the Lynn Canal sockeye
baseline (Table 3; Figure 7).</p>
<p>Table 3: Comparison of root mean-square-errors for each age class
among the two model algorithms.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.062\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.063\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Main","Chilkat Main","Chilkat Main","Chilkat Main","Chilkat Main","Chilkat Main","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Juneau","Juneau","Juneau","Juneau","Juneau","Juneau","Other","Other","Other","Other","Other","Other","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Taku Stikine","Taku Stikine","Taku Stikine","Taku Stikine","Taku Stikine","Taku Stikine"],["Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other"],[0.032,0.034,0.025,0.035,0.035,0,0.042,0.036,0.031,0.038,0.046,0,0.043,0.038,0.031,0.034,0.037,0,0.039,0.038,0.039,0.037,0.04,0,0.053,0.053,0.053,0.054,0.057,0,0.049,0.05,0.045,0.049,0.046,0,0.057,0.055,0.056,0.053,0.062,0],[0.032,0.036,0.026,0.034,0.037,0,0.044,0.038,0.033,0.041,0.047,0,0.046,0.038,0.03,0.033,0.039,0,0.04,0.039,0.042,0.037,0.041,0,0.053,0.052,0.06,0.051,0.058,0,0.05,0.054,0.046,0.053,0.048,0,0.057,0.055,0.059,0.054,0.063,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>age<\/th>\n      <th>Cond. GSI<\/th>\n      <th>Fully Bayes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"group","targets":1},{"name":"age","targets":2},{"name":"Cond. GSI","targets":3},{"name":"Fully Bayes","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="mdl_comparison_files/figure-html/mse_lynn-1.png" class="r-plt" alt="Figure 7 mse lynn" width="576"></p>
<p>Figure 7: Root mean-square-errors of each age class for the two model
algorithms using Lynn Canal sockeye baseline.</p>
</div>
<div class="section level4">
<h4 id="bias-1">Bias<a class="anchor" aria-label="anchor" href="#bias-1"></a>
</h4>
<p>The two algorithms of MAGMA exhibited similar amount of biases for
the seven reporting groups of the Lynn Canal sockeye baseline (Figure
8).</p>
<p><img src="mdl_comparison_files/figure-html/bias_lynn-1.png" class="r-plt" alt="Figure 8 bias lynn" width="576"></p>
<p>Figure 8: Bias of each age class for the two model algorithms using
Lynn Canal sockeye baseline.</p>
</div>
<div class="section level4">
<h4 id="deviation-geq-0-1-1">Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
0.1<a class="anchor" aria-label="anchor" href="#deviation-geq-0-1-1"></a>
</h4>
<p>The two model configurations seemed to have similar performance with
Lynn Canal sockeye baseline (Table 4; Figure 9).</p>
<p>Table 4: Comparison of deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
for each age class among the two model algorithms.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.1\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.1\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Main","Chilkat Main","Chilkat Main","Chilkat Main","Chilkat Main","Chilkat Main","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Juneau","Juneau","Juneau","Juneau","Juneau","Juneau","Other","Other","Other","Other","Other","Other","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Taku Stikine","Taku Stikine","Taku Stikine","Taku Stikine","Taku Stikine","Taku Stikine"],["Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other","Age 03","Age 12","Age 13","Age 22","Age 23","Age other"],[0,0.01,0,0,0.03,0,0.04,0.02,0.01,0.02,0.04,0,0.05,0.03,0,0.04,0.03,0,0.02,0.02,0.03,0.03,0.03,0,0.07000000000000001,0.06,0.05,0.05,0.08,0,0.03,0.05,0.01,0.04,0.06,0,0.07000000000000001,0.04,0.09,0.04,0.1,0],[0,0.01,0,0,0.04,0,0.05,0.02,0.01,0.02,0.04,0,0.05,0.01,0,0.02,0.04,0,0.03,0.03,0.03,0.03,0.02,0,0.06,0.06,0.07000000000000001,0.05,0.09,0,0.03,0.06,0.04,0.06,0.07000000000000001,0,0.07000000000000001,0.05,0.1,0.06,0.1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>age<\/th>\n      <th>Cond. GSI<\/th>\n      <th>Fully Bayes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"group","targets":1},{"name":"age","targets":2},{"name":"Cond. GSI","targets":3},{"name":"Fully Bayes","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="mdl_comparison_files/figure-html/deviations_lynn-1.png" class="r-plt" alt="Figure 9 deviation lynn" width="576"></p>
<p>Figure 9: Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
0.1 of each age class for the two model algorithms using Lynn Canal
sockeye baseline.</p>
</div>
<div class="section level4">
<h4 id="gelman-rubin-diagnostic-gr-1">Gelman-Rubin diagnostic (GR)<a class="anchor" aria-label="anchor" href="#gelman-rubin-diagnostic-gr-1"></a>
</h4>
<p>I also compared the convergence of the posterior samples between the
two algorithms by plotting the Gelman-Rubin shrink factor (GR) of 100
simulations in overlapping histograms (Figure 10). The convergence
seemed to be similar between the two algorithms with Lynn Canal sockeye
baseline.</p>
<p><img src="mdl_comparison_files/figure-html/gr_lynn-1.png" class="r-plt" alt="Figure 10 gr lynn" width="864"></p>
<p>Figure 10: Gelman-Rubin diagnostic (GR) of each reporting group for
the two model algorithms.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<div class="section level3">
<h3 id="yukon-chinook-2">Yukon Chinook<a class="anchor" aria-label="anchor" href="#yukon-chinook-2"></a>
</h3>
<p>The comparison of 100 cross-validation analyses of the two algorithms
showed similar precision, RMSE, and bias for the major age classes.
Hybrid conditional GSI showed slightly less deviations compared to the
fully Bayesian algorithm. It is unclear that the slightly lower portions
of deviations for the hybrid conditional GSI were due to chances or
actually an indication of better performance of the algorithm. However,
comparison of convergence diagnostics show little differences between
the two algorithms.</p>
<p>The performance of the two MAGMA algorithms seems to be comparable,
but the running time of the hybrid conditional GSI was shorter. If we
considered time to run the MAGMA model as the monetary currency, hybrid
conditional GSI is like a Chinese electric vehicle with the same
performance but a fraction of the price compared to its US and European
counterpart. From that perspective, there seems to be a clear benefit to
run MAGMA using hybrid conditional GSI algorithm<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Glad that ADF&amp;amp;G does not impose a 100% tariff on
methods developed by other agencies.&lt;/p&gt;"><sup>1</sup></a>.</p>
<p>It is worth noting that this analysis is not comprehensive because
there was only one stratum in the simulation. MAGMA is usually run in a
multi-stratum scenario, and the effects of multiple strata was untested
in this analysis. Also, the analysis was tested using a baseline from a
region that has not used MAGMA. Further assessments should be done with
other baselines (preferably from regions that have employed MAGMA) to
ensure that different baselines yield the same results.</p>
</div>
<div class="section level3">
<h3 id="update-for-october-2024-lynn-canal-3">Update for October 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-october-2024-lynn-canal-3"></a>
</h3>
<p>The hybrid conditional GSI and the traditional fully Bayesian
algorithms showed similar accuracy and precision in the cross-validation
analysis using Lynn Canal sockeye baseline in a multi-stratum scenario.
The results were consistent to the previous analysis using a Yukon
Chinook baseline.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, E., Dann, T., Hoyt, H. (2021). Yukon River Chinook Genetic
Baseline Improvements. Yukon River Panel Restoration and Enhancement
Fund Final Report, URE-163-19N.</p>
<p>Moran, B.M. and E.C. Anderson. 2018. Bayesian inference from the
conditional genetic stock identification model. <em>Canadian Journal of
Fisheries and Aquatic Sciences</em>. 76(4):551-560.</p>
<p>Pella, J. and M. Masuda. 2001. Bayesian methods for analysis of stock
mixtures from genetic characters. <em>Fish. Bull.</em> 99:151–167.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bobby Hsu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
