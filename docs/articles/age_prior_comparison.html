<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Age priors configurations comparison • magma.gsi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Age priors configurations comparison">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">magma.gsi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/age_prior_comparison.html">Age priors configurations comparison</a></li>
    <li><a class="dropdown-item" href="../articles/magma-vignette.html">How not to be engulfed by MAGMA: instructions and model descriptions</a></li>
    <li><a class="dropdown-item" href="../articles/mdl_comparison.html">Comparing MAGMA model algorithms</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/boppingshoe/magma.gsi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="age_prior_comparison_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="age_prior_comparison_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="age_prior_comparison_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="age_prior_comparison_files/datatables-binding-0.34.0/datatables.js"></script><link href="age_prior_comparison_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="age_prior_comparison_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="age_prior_comparison_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="age_prior_comparison_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="age_prior_comparison_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="age_prior_comparison_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="age_prior_comparison_files/selectize-0.12.0/selectize.min.js"></script><link href="age_prior_comparison_files/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="age_prior_comparison_files/crosstalk-1.2.2/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Age priors configurations comparison</h1>
            <h3 data-toc-skip class="subtitle">Mansplaining age priors
of MAGMA</h3>
                        <h4 data-toc-skip class="author">Bobby Hsu</h4>
            
            <h4 data-toc-skip class="date">January 08, 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/boppingshoe/magma.gsi/blob/HEAD/vignettes/articles/age_prior_comparison.Rmd" class="external-link"><code>vignettes/articles/age_prior_comparison.Rmd</code></a></small>
      <div class="d-none name"><code>age_prior_comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<ul>
<li>Mansplain the roles of age priors in the MAGMA model.</li>
<li>Compare three different setups for age priors: 1) conventional flat
priors with an equal value among age classes, 2) flat priors with a
small value and equal among age classes, and 3) unequal prior values
with greater weights concentrating on the major age classes and
close-to-zero values for age classes unobserved in the harvest
sample.</li>
</ul>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Bayesian estimation of MAGMA parameters (i.e., stock proportions,
age-by-stock composition, and individual group membership assignments)
is done through a type of Markov Chain Monte Carlo method called the
Gibbs sampler. The Gibbs sampler algorithm isolates the model parameters
as separate full conditional distributions<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The distribution of a parameter conditioned on the data
and other parameters in the model.&lt;/p&gt;"><sup>1</sup></a>, which can be dealt
with individually and are easier to work with than a joint distribution
of the parameters.</p>
<p>In the Gibbs sampler algorithm for MAGMA, values for the age
proportions are updated based on a Dirichlet distribution with
parameters equal to the sum of 1) the tallies of individuals in each age
class of each population in the mixture and 2) the prior value specified
for each age class. The algorithm then updates the age class memberships
for individuals without an observed age based on the updated age
proportions. New summaries are tallied for the age classes and new age
proportions are being updated. The cycle is repeated until the simulated
values converged to the posterior distribution of the age
proportions.</p>
<p>Conventionally, we set the values of age priors equally among age
classes. For example, if we have nine age classes to estimate, the value
of prior for each age class is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>9</mn></mfrac><annotation encoding="application/x-tex">\frac{1}{9}</annotation></semantics></math>,
and we do so for all populations. If we counted 10 individuals in a
specific age class of a population, the ratio for the empirical data and
prior is 90:1. It is easy to see how the empirical data often overpower
the prior in the Gibbs sampler algorithm. However, if we have no (or a
very small number of) individuals in an age class, age prior will be
more influential than empirical data in determining the age
proportion.</p>
<p>A likelihood-based model shows zero, or near-zero, for an estimate if
no individual is observed in that age class. However, unlike
likelihood-based models, our current setup for age priors of MAGMA model
prevents any age class from being zero, even if we observed no
individual in such age class. It is not necessarily a bad thing to not
force the proportion of an unobserved age class to be zero (i.e.,
“zero-out”). One may believe that an age class exists in the population,
but we do not always end up with individuals of that age class in the
sample because they are rare. By assigning a small value to the prior of
such age class, we ensure that at least some quantity of proportion will
be allocated to that age class during events of absence.</p>
<p>Still, some people prefer to zero-out the unobserved age classes so
the MAGMA model estimates are more comparable to a likelihood-based
framework. Updated MAGMA package has an option for assigning 0’s<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Actually
&lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;−&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;annotation encoding="application/x-tex"&gt;10^{-5}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;.&lt;/p&gt;'><sup>2</sup></a> as age
priors of unobserved age classes. This setup effectively zero-out the
proportion of an age class if it is unobserved in the mixture. There is
another option in the MAGMA package that assigns a small value<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Conventional flat priors
&lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;×&lt;/mi&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding="application/x-tex"&gt;\times \frac{1}{10}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;.&lt;/p&gt;'><sup>3</sup></a> to age
priors equally across all age classes. This third option minimizes the
proportions of unobserved age classes without forcing them to be
zeros.</p>
<p>However, we don’t know the effects of the new setups have on the
estimation of MAGMA model parameters. In this document, I use a
simulation analysis to assess the possible effects of age priors on the
accuracy and precision of the estimation of the MAGMA model. I run
simulated data sets using the above-mentioned three age prior
configurations and compare the results.</p>
<div class="section level3">
<h3 id="update-for-september-2024-lynn-canal">Update for September 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-september-2024-lynn-canal"></a>
</h3>
<p>I updated the analysis with Lynn Canal sockeye baseline and a
multi-stratum set up. Lynn Canal post-season reporting has 251
collections divided into seven groups. Majority of collections are
included in the “Other” reporting group. For age, there are 15 classes
total. Five of them are major age classes (03, 12, 13, 22, 23), and the
rest are included in “other.”</p>
</div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="yukon-chinook">Yukon Chinook<a class="anchor" aria-label="anchor" href="#yukon-chinook"></a>
</h3>
<p>I used a Yukon Chinook baseline for the simulation analysis. The
Chinook baseline was modified in a previous analysis and contained only
a portion of the original collections. This modified baseline had a
marker-set of 380 loci that could differentiate Chinook salmon among
four reporting groups from the middle/upper Yukon River (Koyukuk,
Tanana, Upper U.S., and Canada; Lee et al. 2021). I used the modified
baseline to generate 100 sets of MAGMA mixtures (single district, single
subdistrict, and single week) with randomly set age-by-stock
compositions, and ran the mixtures using the three configurations of age
priors. Finally, I calculated and compared root mean-square-errors
(RMSE), deviations, and bias for the 100 analyses.</p>
<p>Procedures for generating one set of MAGMA data are as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Randomly set proportions for the four reporting groups. Based on
the set proportions, randomly allocate 190 individuals to populations
within each reporting group.</p></li>
<li><p>Simulate genotypes of mixture individuals based on the baseline
allele frequencies corresponding to their assigned population
memberships. The simulated values are drawn from multinomial
distributions.</p></li>
<li><p>randomly set proportions for the age-by-stock compositions. The
age-by-stock composition is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">4 \times 9</annotation></semantics></math>
matrix with rows represent reporting groups and columns represent age
classes. There are nine age classes and they are ages 1.1, 1.2, 1.3,
2.1, 2.2, 2.3, 3.1, 3.2, and 3.3. The proportions for ages 1.1, 1.2, and
3.3 are always 0’s in this analysis, and the rest are randomly set. The
age proportions within each reporting group add up to 1.</p></li>
<li><p>Assign an age for each mixture individual based on its assigned
reporting group membership. Randomly withheld the age identities for 15%
of the mixture individuals.</p></li>
<li><p>Format the data set for MAGMA model (i.e., magmatize data). There
is only one district, one subdistrict, and one week in the mixture data
set.</p></li>
</ol>
<p>I ran each of the 100 MAGMA data sets with three configurations of
age priors: 1) “flat”: conventional flat priors with an equal value
among age classes, 2) “weak flat”: flat priors with a small value and
equal among age classes, and 3) “zero out”: unequal prior values with
greater weights concentrating on the major age classes and 0’s for age
classes unobserved in the harvest sample. I ran each model with 1,000
iterations, 500 burn-ins, no thinning, and four chains in the “hybrid”
conditional GSI mode. I compared the posterior means and the true
proportions of the nine age classes and calculated RMSE and
bias/deviation. RMSE is calculated as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mi>E</mi><mo>=</mo><msqrt><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mi>i</mi></msub><mo>−</mo><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (Y_i - \hat Y_i)^2}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
was the number of cross-validation analyses,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>i</mi></msub><annotation encoding="application/x-tex">Y_i</annotation></semantics></math>
was the true proportion of age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math><sup>th</sup>
analysis, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>Y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><annotation encoding="application/x-tex">\hat Y_i</annotation></semantics></math>
was the posterior mean proportion of age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math><sup>th</sup>
analysis. Bias was derived by taking the difference between the
posterior mean and the true proportion of each age class for each
cross-validation analysis. “Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≥</mo><annotation encoding="application/x-tex">\geq</annotation></semantics></math>
0.1” quantified the portion of the cross-validation analyses with
absolute biases greater or equal to 0.1.</p>
</div>
<div class="section level3">
<h3 id="update-for-september-2024-lynn-canal-1">Update for September 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-september-2024-lynn-canal-1"></a>
</h3>
<p>Simulations for Lynn Canal followed the same procedures as before,
with addition of multiple strata. There were one district and two
subdistricts with two weeks each. Age-by-stock composition was a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn><mo>×</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">7 \times 15</annotation></semantics></math>
matrix for the whole district. I ran two sets of simulations. The first
set had 0 portion for all minor age classes. The second set had a small
portion (randomly set) for some of the minor age classes.</p>
<p>Harvest were randomly selected from the 2023 harvest record to
represent a simulated harvest for the four strata in each iteration of
the analysis. Sample size for each stratum was randomly drawn from a
negative binomial distribution with a mean of 190 fish and a dispersion
parameter of 8
(Neg-bin(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
= 190, size = 8)). I ran total of 50 iterations (to save time).</p>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="yukon-chinook-1">Yukon Chinook<a class="anchor" aria-label="anchor" href="#yukon-chinook-1"></a>
</h3>
<div class="section level4">
<h4 id="precision">Precision<a class="anchor" aria-label="anchor" href="#precision"></a>
</h4>
<p>I plotted the comparisons between the posterior means and the true
values in Figure 1. performance of the three configurations were similar
for the major age classes (1.3, 2.1, 2.2, 2.3, 3.1, and 3.2). “Zero out”
configuration performed better for the age classes with 0 proportion
(1.1, 1.2, and 3.3) compared to others (Figure 1).</p>
<p><img src="age_prior_comparison_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="Figure 1 precision yukon chinook age" width="960">
Figure 1: Comparison between the posterior means and the true values of
the 100 cross-validation analyses for the three age prior
configurations: ‘flat,’ ‘weak flat,’ and ‘zero out.’ Red diagonal line
represents 1:1 relationship between the true proportions and the
posterior means. Dashed red lines mark the ± 0.1 deviation from the 1:1
line.</p>
</div>
<div class="section level4">
<h4 id="rmse">RMSE<a class="anchor" aria-label="anchor" href="#rmse"></a>
</h4>
<p>For the major age classes, performances of the three configuration
were similar. “Zero out” had the lowest RMSE for age classes with 0
proportion (Table 1; Figure 2).</p>
<p>Table 1: Comparison of root mean-square-errors for each age class
among the three age prior configurations.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.024\" data-max=\"0.061\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.016\" data-max=\"0.06\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.063\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9"],["Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33"],[0.024,0.024,0.061,0.048,0.056,0.045,0.05,0.052,0.024],[0.016,0.016,0.059,0.048,0.053,0.047,0.052,0.06,0.016],[0,0,0.054,0.048,0.055,0.046,0.054,0.063,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>Flat<\/th>\n      <th>Weak flat<\/th>\n      <th>Zero out<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"age","targets":1},{"name":"Flat","targets":2},{"name":"Weak flat","targets":3},{"name":"Zero out","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="age_prior_comparison_files/figure-html/mse-1.png" class="r-plt" alt="Figure 2 mse yukon chinook age" width="864">
Figure 2: Root mean-square-errors of each age class for the three age
prior configurations.</p>
</div>
<div class="section level4">
<h4 id="bias">Bias<a class="anchor" aria-label="anchor" href="#bias"></a>
</h4>
<p>Three configurations for age priors exhibited similar amount of
biases for the major age classes (Figure 3). For the age classes with 0
proportion, “weak flat” showed less biases than “flat,” and “zero out”
had the least biases among the three configurations (Figure 3).</p>
<p><img src="age_prior_comparison_files/figure-html/bias-1.png" class="r-plt" alt="Figure 3 bias yukon chinook age" width="480"></p>
<p>Figure 3: Bias of each age class for the three age prior
configurations.</p>
</div>
<div class="section level4">
<h4 id="deviation-geq-0-1">Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#deviation-geq-0-1"></a>
</h4>
<p>“Weak flat” prior configuration seemed to perform slightly better
than others for the major age classes, but it was mostly due to the
randomness in the simulations. Overall, the three configurations showed
similar performances. For the age classes with 0 proportion, “zero out”
had the least deviations (Table 2; Figure 4).</p>
<p>Table 2: Comparison of deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
for each age class among the three age prior configurations.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.015\" data-max=\"0.062\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.015\" data-max=\"0.052\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.068\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9"],["Age 11","Age 12","Age 13","Age 21","Age 22","Age 23","Age 31","Age 32","Age 33"],[0.018,0.018,0.058,0.062,0.062,0.043,0.055,0.043,0.015],[0.015,0.015,0.05,0.052,0.05,0.045,0.052,0.035,0.015],[0,0,0.05,0.058,0.068,0.05,0.058,0.04,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>Flat<\/th>\n      <th>Weak flat<\/th>\n      <th>Zero out<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"age","targets":1},{"name":"Flat","targets":2},{"name":"Weak flat","targets":3},{"name":"Zero out","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="age_prior_comparison_files/figure-html/deviations-1.png" class="r-plt" alt="Figure 4 deviation yukon chinook age" width="864">
Figure 4: Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
of each age class for the three age prior configurations.</p>
</div>
</div>
<div class="section level3">
<h3 id="update-for-september-2024-lynn-canal-2">Update for September 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-september-2024-lynn-canal-2"></a>
</h3>
<div class="section level4">
<h4 id="true-0-proportions-for-minor-age-classes">True 0 proportions for minor age classes<a class="anchor" aria-label="anchor" href="#true-0-proportions-for-minor-age-classes"></a>
</h4>
<div class="section level5">
<h5 id="precision-1">Precision<a class="anchor" aria-label="anchor" href="#precision-1"></a>
</h5>
<p>Performance of the three configurations were similar for the three
configurations (Figure 5). Dots for the “weak flat” configuration seemed
more diffused compared to others, but not very noticeable (Figure
5).</p>
<p><img src="age_prior_comparison_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="Figure 5 precision lynn age" width="960">
Figure 5: Comparison between the posterior means and the true values of
the 50 cross-validation analyses for the three age prior configurations:
‘flat,’ ‘weak flat,’ and ‘zero out’ using Lynn Canal sockeye baseline.
True 0 proportions for minor age classes. Diagonal line represents 1:1
relationship between the true proportions and the posterior means.
Dashed lines mark the ± 0.1 deviation from the 1:1 line.</p>
</div>
<div class="section level5">
<h5 id="rmse-1">RMSE<a class="anchor" aria-label="anchor" href="#rmse-1"></a>
</h5>
<p>“Other” age class of “Other” reporting group had the highest errors
across all three configurations. “Weak-flat” priors had higher errors
overall compared to “flat” and “zero-out” (Table 3; Figure 6).</p>
<p>Table 3: Comparison of root mean-square-errors for each age class
among the three age prior configurations using Lynn Canal sockeye
baseline. True 0 proportions for minor age classes.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.004\" data-max=\"0.065\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.001\" data-max=\"0.077\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.065\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Other","Other","Other","Other","Other","Other","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem"],["03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other"],[0.029,0.034,0.031,0.03,0.033,0.004,0.035,0.035,0.032,0.037,0.036,0.006,0.031,0.027,0.03,0.027,0.028,0.005,0.038,0.035,0.036,0.044,0.037,0.012,0.047,0.039,0.055,0.065,0.048,0.057,0.052,0.046,0.046,0.046,0.034,0.006,0.055,0.056,0.054,0.059,0.044,0.017],[0.031,0.037,0.036,0.032,0.034,0.001,0.037,0.041,0.04,0.041,0.042,0.001,0.032,0.032,0.032,0.028,0.03,0.001,0.053,0.046,0.043,0.057,0.054,0.002,0.066,0.056,0.066,0.077,0.06,0.019,0.052,0.06,0.05,0.047,0.041,0.001,0.057,0.07000000000000001,0.067,0.063,0.062,0.003],[0.03,0.036,0.03,0.033,0.033,0,0.034,0.033,0.031,0.035,0.036,0,0.029,0.026,0.028,0.025,0.027,0,0.038,0.035,0.035,0.044,0.038,0,0.045,0.038,0.051,0.065,0.043,0,0.049,0.046,0.046,0.044,0.033,0,0.054,0.053,0.053,0.052,0.047,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>age<\/th>\n      <th>flat<\/th>\n      <th>weak_flat<\/th>\n      <th>zero_out<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"group","targets":1},{"name":"age","targets":2},{"name":"flat","targets":3},{"name":"weak_flat","targets":4},{"name":"zero_out","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="age_prior_comparison_files/figure-html/mse_lynn-1.png" class="r-plt" alt="Figure 6 mse lynn age" width="576"></p>
<p>Figure 6: Root mean-square-errors of each age class for the three age
prior configurations using Lynn Canal sockeye baseline. True 0
proportions for minor age classes.</p>
</div>
<div class="section level5">
<h5 id="bias-1">Bias<a class="anchor" aria-label="anchor" href="#bias-1"></a>
</h5>
<p>Three configurations for age priors exhibited similar amount of
biases for the major age classes (Figure 7). For the “other” age classes
with 0 proportions, “flat” priors showed the most biases. And “zero out”
priors had the least biases among the three configurations (Figure
7).</p>
<p><img src="age_prior_comparison_files/figure-html/bias_lynn-1.png" class="r-plt" alt="Figure 7 bias lynn age" width="576"></p>
<p>Figure 7: Bias of each age class for the three age prior
configurations using Lynn Canal sockeye baseline. True 0 proportions for
minor age classes.</p>
</div>
<div class="section level5">
<h5 id="deviation-geq-0-1-1">Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#deviation-geq-0-1-1"></a>
</h5>
<p>“Weak flat” prior configuration seemed to have the most deviation
overall compared to others. For the “other” age class of “Other”
reporting group, “zero out” and “flat” priors showed similar amount of
deviations (Table 4; Figure 8).</p>
<p>Table 4: Comparison of deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
for each age class among the three age prior configurations using Lynn
Canal sockeye baseline. True 0 proportions for minor age classes.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-febe03efa1a2d8d52a86" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.15\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.24\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.12\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other"],["Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Other","Other","Other","Other","Other","Other","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem"],[0,0.02,0.02,0,0,0,0,0.02,0,0,0.02,0,0,0,0,0,0,0,0.02,0.02,0.02,0.04,0.04,0,0.04,0,0.06,0.14,0.06,0,0.06,0.04,0.02,0.04,0.02,0,0.04,0.04,0.06,0.08,0.04,0],[0,0.02,0.02,0,0,0,0,0.04,0,0.02,0.02,0,0,0.02,0,0,0,0,0.08,0.06,0.04,0.08,0.08,0,0.12,0.1,0.18,0.24,0.08,0,0.06,0.12,0.08,0.04,0.02,0,0.08,0.1,0.08,0.12,0.1,0],[0,0.02,0.02,0,0,0,0,0,0,0,0.02,0,0,0,0,0,0,0,0.04,0.02,0.02,0.04,0.04,0,0,0.02,0.06,0.12,0.04,0,0.06,0.06,0.02,0.04,0,0,0.06,0.04,0.08,0.04,0.04,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>group<\/th>\n      <th>flat<\/th>\n      <th>weak_flat<\/th>\n      <th>zero_out<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"age","targets":1},{"name":"group","targets":2},{"name":"flat","targets":3},{"name":"weak_flat","targets":4},{"name":"zero_out","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="age_prior_comparison_files/figure-html/deviations_lynn-1.png" class="r-plt" alt="Figure 8 deviationlynn age" width="576"></p>
<p>Figure 8: Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
of each age class for the three age prior configurations using Lynn
Canal sockeye baseline. True 0 proportions for minor age classes.</p>
</div>
</div>
<div class="section level4">
<h4 id="small-proportions-for-some-of-the-minor-age-classes">Small proportions for some of the minor age classes<a class="anchor" aria-label="anchor" href="#small-proportions-for-some-of-the-minor-age-classes"></a>
</h4>
<div class="section level5">
<h5 id="precision-2">Precision<a class="anchor" aria-label="anchor" href="#precision-2"></a>
</h5>
<p>Performance of the “weak flat” configurations seemed to be less ideal
compared to “flat” and “zero out”. Dots of “weak flat” configuration
seemed more diffused overall (Figure 9).</p>
<p><img src="age_prior_comparison_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="Figure 9 precision lynn small age" width="960">
Figure 9: Comparison between the posterior means and the true values of
the 50 cross-validation analyses for the three age prior configurations:
‘flat,’ ‘weak flat,’ and ‘zero out’ using Lynn Canal sockeye baseline.
Small proportions for some of the minor age classes. Diagonal line
represents 1:1 relationship between the true proportions and the
posterior means. Dashed lines mark the ± 0.1 deviation from the 1:1
line.</p>
</div>
<div class="section level5">
<h5 id="rmse-2">RMSE<a class="anchor" aria-label="anchor" href="#rmse-2"></a>
</h5>
<p>“Zero out” and “flat” priors showed similar amount of errors, and
“weak flat” had the highest RMSE overall (Table 5; Figure 10).</p>
<p>Table 5: Comparison of root mean-square-errors for each age class
among the three age prior configurations using Lynn Canal sockeye
baseline. Small proportions for some of the minor age classes.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-1fb4450895fe099f74a1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.017\" data-max=\"0.062\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.022\" data-max=\"0.082\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.017\" data-max=\"0.064\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Other","Other","Other","Other","Other","Other","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem"],["03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other"],[0.028,0.03,0.04,0.038,0.028,0.02,0.032,0.036,0.046,0.033,0.032,0.02,0.036,0.034,0.032,0.04,0.036,0.017,0.04,0.037,0.044,0.038,0.037,0.023,0.052,0.05,0.052,0.049,0.057,0.054,0.059,0.045,0.05,0.048,0.052,0.053,0.058,0.057,0.062,0.062,0.061,0.029],[0.029,0.029,0.038,0.039,0.033,0.022,0.039,0.043,0.055,0.04,0.034,0.025,0.038,0.029,0.031,0.044,0.042,0.022,0.05,0.047,0.05,0.049,0.053,0.028,0.062,0.067,0.076,0.063,0.073,0.051,0.073,0.055,0.06,0.056,0.064,0.049,0.07000000000000001,0.067,0.066,0.075,0.082,0.03],[0.029,0.032,0.038,0.04,0.033,0.019,0.032,0.034,0.045,0.031,0.032,0.019,0.037,0.029,0.031,0.038,0.035,0.017,0.038,0.037,0.043,0.038,0.036,0.024,0.048,0.047,0.049,0.047,0.058,0.037,0.054,0.049,0.057,0.047,0.051,0.05,0.054,0.053,0.059,0.061,0.064,0.029]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>group<\/th>\n      <th>age<\/th>\n      <th>flat<\/th>\n      <th>weak_flat<\/th>\n      <th>zero_out<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"group","targets":1},{"name":"age","targets":2},{"name":"flat","targets":3},{"name":"weak_flat","targets":4},{"name":"zero_out","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="age_prior_comparison_files/figure-html/mse_lynn_small-1.png" class="r-plt" alt="Figure 10 mse lynn small age" width="576"></p>
<p>Figure 10: Root mean-square-errors of each age class for the three
age prior configurations using Lynn Canal sockeye baseline. Small
proportions for some of the minor age classes.</p>
</div>
<div class="section level5">
<h5 id="bias-2">Bias<a class="anchor" aria-label="anchor" href="#bias-2"></a>
</h5>
<p>Three configurations showed similar amount of biases (Figure 11).</p>
<p><img src="age_prior_comparison_files/figure-html/bias_lynn_small-1.png" class="r-plt" alt="Figure 11 bias lynn small age" width="576"></p>
<p>Figure 11: Bias of each age class for the three age prior
configurations using Lynn Canal sockeye baseline. Small proportions for
some of the minor age classes.</p>
</div>
<div class="section level5">
<h5 id="deviation-geq-0-1-2">Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#deviation-geq-0-1-2"></a>
</h5>
<p>“Weak flat” prior configuration seemed to have the most deviations
compared to others (Table 6,; Figure 12).</p>
<p>Table 6: Comparison of deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
for each age class among the three age prior configurations using Lynn
Canal sockeye baseline. Small proportions for some of the minor age
classes.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-10b3b7155e8045a1b2ad" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.12\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.18\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"0.12\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],["03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other","03","12","13","22","23","other"],["Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Lake","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkat Mainstem","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Chilkoot","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Juneau Mainland","Other","Other","Other","Other","Other","Other","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Snettisham","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem","Taku RiverStikine Mainstem"],[0,0,0.04,0.02,0.02,0,0.02,0.02,0.04,0,0,0,0,0.02,0,0.02,0.02,0,0,0,0.04,0.02,0.02,0,0.06,0.06,0.04,0.06,0.12,0.04,0.04,0.06,0.04,0.04,0.06,0.06,0.1,0.1,0.04,0.08,0.1,0],[0,0,0.02,0.02,0.02,0,0.04,0.04,0.06,0.04,0,0,0.04,0,0,0.02,0.06,0,0.06,0.04,0.06,0.04,0.02,0,0.1,0.16,0.14,0.12,0.18,0.08,0.18,0.12,0.06,0.08,0.1,0.04,0.18,0.18,0.08,0.18,0.12,0],[0,0.02,0.04,0.04,0.02,0,0.02,0.02,0.06,0,0,0,0,0,0,0.02,0.02,0,0,0.02,0.06,0.02,0,0,0.02,0.06,0.04,0.04,0.1,0.02,0.08,0.1,0.06,0.04,0.06,0.04,0.08,0.06,0.12,0.08,0.08,0.02]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>group<\/th>\n      <th>flat<\/th>\n      <th>weak_flat<\/th>\n      <th>zero_out<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"age","targets":1},{"name":"group","targets":2},{"name":"flat","targets":3},{"name":"weak_flat","targets":4},{"name":"zero_out","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p><img src="age_prior_comparison_files/figure-html/deviations_lynn_small-1.png" class="r-plt" alt="Figure 12 deviation lynn small age" width="576"></p>
<p>Figure 12: Deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\geq 0.1</annotation></semantics></math>
of each age class for the three age prior configurations using Lynn
Canal sockeye baseline. Small proportions for some of the minor age
classes.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<div class="section level3">
<h3 id="yukon-chinook-2">Yukon Chinook<a class="anchor" aria-label="anchor" href="#yukon-chinook-2"></a>
</h3>
<p>The comparison of 100 cross-validation analyses of the three age
prior configurations showed similar precision and accuracy for the major
age classes. “Zero out” and “weak flat” priors had the intended purpose
of reducing bias for the age classes with 0 proportion.</p>
<p>It is worth noting that the “true values” in these cross-validation
analyses were the observed proportions of the simulated data.
Proportions of the simulated data might deviate from the (randomly set)
population values that were used as the reference when constructing the
mixture samples. The differences between the simulated values and the
true population values were referred to as the <em>sampling errors</em>,
which I ignored mainly to confine the variables of the analysis to the
configurations of age priors. Still, it might be worthwhile to assess
the performance of the MAGMA model with presence of sampling errors in
the future analyses.</p>
</div>
<div class="section level3">
<h3 id="update-for-september-2024-lynn-canal-3">Update for September 2024 (Lynn Canal)<a class="anchor" aria-label="anchor" href="#update-for-september-2024-lynn-canal-3"></a>
</h3>
<p>The set up for Lynn Canal lumps majority of collections into “Other”
reporting group and makes it the biggest. Furthermore, “other” age class
is also the biggest age class with 10 minor age classes.
Cross-validation simulations demonstrate how the biases in each groups
are accumulated and show up in the results. “zero out” configuration
helps minimizing the biases in the minor age classes if we don’t expect
to see them in the data. However, if there are a low number of samples
in minor age classes observed in the data, the results are similar for
“flat” and “zero out” configurations.</p>
<p>Simulation using Lynn Canal sockeye baseline has a multi-stratum set
up. Multiple strata might also increase biases in the “other” age
classes because the estimates are averaged across the strata. But I’m
not quite sure the influence of the multi-strata.</p>
<p>Talking to Kyle (GCL fishery geneticist), it seems that biases in
“other” groups (age class and reporting) would not be a big concern
because they consist of only a small portion in MSA. Plus, these groups
are not used by the SEAK biologists.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, E., Dann, T., Hoyt, H. (2021). Yukon River Chinook Genetic
Baseline Improvements. Yukon River Panel Restoration and Enhancement
Fund Final Report, URE-163-19N.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bobby Hsu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
